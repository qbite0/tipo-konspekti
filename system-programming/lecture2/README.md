---
начат: 05.09.2022
закончен: 07.09.2022
тема: Решение классических проблем с синхронизацией
---

# Решение классических проблем с синхронизацией
1) Проблема взаимного исключения
Проблема ограниченного буфера

# Безопасная синхронизация с использованием системных вызовов
События подразделяются на мануальные и единичные. Мануальные события - это такой флаг любой поток которого может устанавливаться с помощью системного вызова. 

Если тип события единично то польсе того как событие произойдёт только один из ожидающих потоков получит информацию об этом и сможет продолжить работу. Когда несколько потоков ожидают то рекомендуется использовать мануальное событие.
* CreateEvent - создаёт событие.
* SetEvent позволяет определеить что будет использоваться мануальное событие,
* ResetEvent - сбрасывает мануальное событие.
* PuaseEvent - пфереводит событие в сигнальное состояние.

1) Поясните цели синхронизации процессов и потоков в многозадачных ОС.
Синхронизация необходи­ма для исключения гонок и тупиков при обмене данными между потоками, раз­делении данных, при доступе к процессору и устройствам ввода-вывода.
2) Приведите пример взаимной блокировки процессов (потоков).
Например, мы используем синхронизацию для поточной безопасности (thread safety), при этом в случаи, неверного порядка синхронизации, мы можем вызвать взаимную блокировки. Так же, мы используем пулы потоков и семафоры, для ограничения потребления ресурсов, при этом ошибка в таком дизайне может привести к взаимной блокировке, вследствие недостатка ресурсов.
3) Кратко охарактеризуйте основные объекты синхронизации в ОС Windows.
Mutex 	Может принадлежать только одному потоку за раз, что позволяет потокам координировать взаимоисключающий доступ к общему ресурсу. Дополнительные сведения см. в разделе "Объекты Мьютекса"
Semaphore 	Поддерживает количество от нуля до максимального значения, ограничивая количество потоков, одновременно обращаюющихся к общему ресурсу. Дополнительные сведения см. в разделе "Объекты Семафора".
Таймер ожидания 	Уведомляет один или несколько ожидающих потоков о том, что указанное время пришло. Дополнительные сведения см. в разделе "Объекты таймера ожидания".
4) Что такое «сигнальное» и «свободное» состояние объекта синхронизации? Приведите примеры.
Все эти объекты могут находиться в двух состояниях: сигнальном и несигнальном – свободном. Смысл, вкладываемый в понятие сигнальное состояние, зависит от типа объекта. Так, например, поток переходит в сигнальное состояние, когда он завершается. Процесс переходит в сигнальное состояние, когда завершились все его потоки. Файл переходит в сигнальное состояние, когда завершается операция ввода-вывода для этого файла. Для остальных объектов сигнальное состояние устанавливаются в результате выполнения специальных системных вызовов. Приостановка и активизация потоков осуществляется в зависимости от состояния синхронизирующих объектов ОС.
5) Сформулируйте особенности событий как объектов синхронизации.
Объект синхронизации — это объект, дескриптор которого можно указать в одной из функций ожидания для координации выполнения нескольких потоков. Несколько процессов могут иметь дескриптор одного объекта синхронизации, что делает синхронизацию межпроцессной обработки возможной.
6) Перечислите системные вызовы для работы с событиями.
Управление процессами
 load
 execute
 end (exit), abort
Работа с файлами
 create file, delete file
 open, close
 read, write, reposition
Управление устройствами
 request device, release device
 read, write, reposition
Работа с информацией
 get/set time or date
 get/set system data
Связь, коммуникация
 create, delete communication connection
 send, receive messages
7) Составьте и выполните программу с использованием событий.
8) Чем отличаются мануальные и единичные события?
9) Что такое мьютекс?
Мьютекс - примитив синхронизации, обеспечивающий взаимное исключение исполнения критических участков кода
10) Поясните общие свойства и различия при использовании событий и мьютексов.
Защита объекта от доступа к нему других потоко, отличных от того, который завладел мьютекс. Взаимное исключение. Защита данных от повреждения.
11) Объясните синтаксис функции CreateMutex.
CreateMutex используется для создания объекта мьютекса и функции CreateThread для создания рабочих потоков.
12) Продемонстрируйте применение мьютекса в программе.
```cpp
#include <iostream>
#include <chrono>
#include <thread>
#include <mutex>
 
std::mutex g_lock;
 
void threadFunction() {
     g_lock.lock();
 
     std::cout << "entered thread " << std::this_thread::get_id() << std::endl;
     std::this_thread::sleep_for(std::chrono::seconds(rand()%10));
     std::cout << "leaving thread " << std::this_thread::get_id() << std::endl;
 
     g_lock.unlock();
}
 
int main() {
     srand((unsigned int)time(0));
     std::thread t1(threadFunction);
     std::thread t2(threadFunction);
     std::thread t3(threadFunction);
     t1.join();
     t2.join();
     t3.join();
     return 0;
}
```
13) Сформулируйте определение семафора.
Семафор - примитив синхронизации работы процессов и потоков, в основе которого лежит счетчик, над которым можно производить две атомарные опреации: увеличение и уменьшение значения на единицу, при этом операция уменьшения для нулевого значения счетчика является блокирующейся.
14) Поясните синтаксис системного вызова OpenSemaphore.
Открытие существующего семафора с помощью данной функции. Флаги доступа, передаваемые через параметр fdwAccess, определяют требуемый уровень доступа к семафору.
15) Составьте пример программы с использованием
16) Объясните различия между мьютексами и семафорами.
Основное различие между семафором и мьютексом состоит в том, что семафор является механизмом сигнализации, т.е. процессы выполняют операции wait () и signal (), чтобы указать, получают ли они ресурс или освобождают его, в то время как Mutex является механизмом блокировки, процесс должен получить блокировку на объект мьютекса, если он хочет получить ресурс.
17) Что общего в работе всех объектов синхронизации?
Несколько примитивов синхронизации .NET являются производными от класса System.Threading.WaitHandle, который инкапсулирует собственный дескриптор операционной системы синхронизации и использует механизм сигнализации для взаимодействия потоков.